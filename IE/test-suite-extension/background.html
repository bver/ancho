<!doctype html>
<html>
<head>
  <title>Test Runner</title>
  <link rel="stylesheet" type="text/css" href="./vendor/jasmine/jasmine.css">
  <script src="./vendor/jasmine/jasmine.js"></script>
  <script src="./vendor/jasmine/jasmine-html.js"></script>
  <script>
  var require = {
    paths: {}
  }
  </script>
  <script src="./vendor/require.js"></script>
  <script src="./ConsoleReporter.js"></script>
</head>
<body>

<script>
  require(
  [
    'spec/chromeEvents',
    'spec/chromeExtension',
    'spec/chromeTabs'
  ],
  function() {
    jasmine.getEnv().addReporter(new ConsoleReporter(console));
    jasmine.getEnv().execute();
  });
  
  console.log('Adding listener to chrome.extension.onMessage');
  chrome.extension.onMessage.addListener( function(msg, sender, sendResponse){
      console.log('Message received : ' + msg );
      if (sendResponse) {
        sendResponse();
        sendResponse();
      } else {
         console.log('Message responseCallback unavailable');
      }
      return true;
  });
  
  console.log('Adding listener to chrome.extension.onConnect');
  chrome.extension.onConnect.addListener( function(port){
      console.log('Adding listener to port.onMessage');
      port.onMessage.addListener( function(msg) {
          console.log('Message from port recieved: ' + msg);
          console.log('Sending response!');
          port.postMessage('Responding to message received through port');
      });
  });

console.log('TAB CREATING');
chrome.tabs.create({'url': 'http://www.centrum.cz' }, function(tab){console.log("--------" + tab.url); });
console.log('TAB CREATED');

console.log('GETTING TAB');
chrome.tabs.get(1,function(tab){console.log("TAAAAAAAAAAB " + tab.url + " active = " + tab.active);});
console.log('AFTER GETTING TAB');

</script>


</body>
</html>